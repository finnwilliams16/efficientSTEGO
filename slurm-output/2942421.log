/var/spool/slurmd/job2942421/slurm_script: line 16: .bashrc: No such file or directory
/var/spool/slurmd/job2942421/slurm_script: line 21: setenv_nvcc: No such file or directory
Mon 24 Apr 17:35:09 BST 2023
src/train_segmentation.py:356: UserWarning: 
The version_base parameter is not specified.
Please specify a compatability version level, or None.
Will assume defaults for version 1.1
  @hydra.main(config_path="configs", config_name="train_config.yml") # Defines main function to run
/home/acb19fw/.conda/envs/stego_nvcc/lib/python3.6/site-packages/hydra/plugins/config_source.py:125: UserWarning: Support for .yml files is deprecated. Use .yaml extension for Hydra config files
  "Support for .yml files is deprecated. Use .yaml extension for Hydra config files"
/home/acb19fw/.conda/envs/stego_nvcc/lib/python3.6/site-packages/hydra/_internal/hydra.py:127: UserWarning: Future Hydra versions will no longer change working directory at job runtime by default.
See https://hydra.cc/docs/next/upgrades/1.1_to_1.2/changes_to_job_working_dir/ for more information.
  configure_logging=with_log_configuration,
Global seed set to 0
output_root: ../
pytorch_data_dir: /shared/mvg_dcs/UG_22-23/finn
experiment_name: exp1
log_dir: cityscapes
azureml_logging: false
submitting_to_aml: false
subset: false
progress_bar: false
epochs: 100
head: dpc
num_workers: 10
max_steps: 500000
batch_size: 16
num_neighbors: 7
dataset_name: cityscapes
dir_dataset_name: null
dir_dataset_n_classes: 5
has_labels: false
crop_type: five
crop_ratio: 0.5
res: 224
loader_crop_type: center
extra_clusters: 0
use_true_labels: false
use_recalibrator: false
model_type: vit_small
arch: dino
use_fit_model: false
dino_feat_type: feat
projection_type: nonlinear
dino_patch_size: 8
granularity: 1
continuous: true
dim: 70
dropout: true
zero_clamp: true
lr: 0.0005
pretrained_weights: null
use_salience: false
stabalize: false
stop_at_zero: true
pointwise: true
feature_samples: 11
neg_samples: 5
aug_alignment_weight: 0.0
correspondence_weight: 1.0
neg_inter_weight: 0.9058762625226623
pos_inter_weight: 0.577453483136995
pos_intra_weight: 1
neg_inter_shift: 0.31361241889448443
pos_inter_shift: 0.1754346515479633
pos_intra_shift: 0.45828472207
rec_weight: 0.0
repulsion_weight: 0.0
crf_weight: 0.0
alpha: 0.5
beta: 0.15
gamma: 0.05
w1: 10.0
w2: 3.0
shift: 0.0
crf_samples: 1000
color_space: rgb
reset_probe_steps: null
n_images: 5
scalar_log_freq: 1
checkpoint_freq: 50
val_freq: 100
hist_freq: 100

../data
../
/home/acb19fw/.conda/envs/stego_nvcc/lib/python3.6/site-packages/torchvision/transforms/transforms.py:258: UserWarning: Argument interpolation should be of type InterpolationMode instead of int. Please, use InterpolationMode enum.
  "Argument interpolation should be of type InterpolationMode instead of int. "
/home/acb19fw/.conda/envs/stego_nvcc/lib/python3.6/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Torchmetrics v0.9 introduced a new argument class property called `full_state_update` that has
                not been set for this class (UnsupervisedMetrics). The property determines if `update` by
                default needs access to the full metric state. If this is not the case, significant speedups can be
                achieved and we recommend setting this to `False`.
                We provide an checking function
                `from torchmetrics.utilities import check_forward_full_state_property`
                that can be used to check if the `full_state_update=True` (old and potential slower behaviour,
                default for now) or if `full_state_update=False` can be used safely.
                
  warnings.warn(*args, **kwargs)
/home/acb19fw/.conda/envs/stego_nvcc/lib/python3.6/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py:287: LightningDeprecationWarning: Passing `Trainer(accelerator='ddp')` has been deprecated in v1.5 and will be removed in v1.7. Use `Trainer(strategy='ddp')` instead.
  f"Passing `Trainer(accelerator={self.distributed_backend!r})` has been deprecated"
Multi-processing is handled by Slurm.
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
Global seed set to 0
initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
here1
here2
Since no pretrained weights have been provided, we load the reference pretrained DINO weights.
/home/acb19fw/git/STEGO_v2/logs/cityscapes/cityscapes_exp1_date_Apr24_17-35-24
[2023-04-24 17:35:40,252][root][INFO] - Added key: store_based_barrier_key:1 to store for rank: 0
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/acb19fw/.conda/envs/stego_nvcc/lib/python3.6/site-packages/pytorch_lightning/loggers/tensorboard.py:251: UserWarning: Could not log computational graph since the `model.example_input_array` attribute is not set or `input_array` was not given
  UserWarning,
Missing logger folder: /home/acb19fw/git/STEGO_v2/logs/cityscapes/cityscapes_exp1_date_Apr24_17-35-24/default
Set SLURM handle signals.

   | Name                     | Type                       | Params
-------------------------------------------------------------------------
0  | net                      | DinoFeaturizer             | 21.7 M
1  | train_cluster_probe      | ClusterLookup              | 1.9 K 
2  | cluster_probe            | ClusterLookup              | 1.9 K 
3  | linear_probe             | Conv2d                     | 1.9 K 
4  | decoder                  | Conv2d                     | 27.3 K
5  | cluster_metrics          | UnsupervisedMetrics        | 0     
6  | linear_metrics           | UnsupervisedMetrics        | 0     
7  | test_cluster_metrics     | UnsupervisedMetrics        | 0     
8  | test_linear_metrics      | UnsupervisedMetrics        | 0     
9  | linear_probe_loss_fn     | CrossEntropyLoss           | 0     
10 | crf_loss_fn              | ContrastiveCRFLoss         | 0     
11 | contrastive_corr_loss_fn | ContrastiveCorrelationLoss | 0     
-------------------------------------------------------------------------
59.9 K    Trainable params
21.7 M    Non-trainable params
21.7 M    Total params
86.921    Total estimated model params size (MB)
/home/acb19fw/.conda/envs/stego_nvcc/lib/python3.6/site-packages/torch/nn/functional.py:3458: UserWarning: Default upsampling behavior when mode=bicubic is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  "See the documentation of nn.Upsample for details.".format(mode)
/home/acb19fw/.conda/envs/stego_nvcc/lib/python3.6/site-packages/torch/nn/functional.py:3503: UserWarning: The default behavior for interpolate/upsample with float scale_factor changed in 1.6.0 to align with other frameworks/libraries, and now uses scale_factor directly, instead of relying on the computed output size. If you wish to restore the old behavior, please set recompute_scale_factor=True. See the documentation of nn.Upsample for details. 
  "The default behavior for interpolate/upsample with float scale_factor changed "
Global seed set to 0
/home/acb19fw/.conda/envs/stego_nvcc/lib/python3.6/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: The ``compute`` method of metric UnsupervisedMetrics was called before the ``update`` method which may lead to errors, as metric states have not yet been updated.
  warnings.warn(*args, **kwargs)
[W reducer.cpp:362] Warning: Grad strides do not match bucket view strides. This may indicate grad was not created according to the gradient layout contract, or that the param's strides changed since DDP was constructed.  This is not an error, but may impair performance.
grad.sizes() = [27, 70, 1, 1], strides() = [70, 1, 70, 70]
bucket_view.sizes() = [27, 70, 1, 1], strides() = [70, 1, 1, 1] (function operator())
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
RESETTING TFEVENT FILE
Tue 25 Apr 06:16:36 BST 2023
